---
alwaysApply: false
---
# Cursor Internals - Code Examples

**For database operation examples, see the [cursor-db skill](../cursor-db/EXAMPLES.mdc).**

This file contains examples for Cursor authentication and cursor-agent CLI usage.

## Working with cursor-agent CLI

```python
import subprocess
import json

def create_chat_with_cursor_agent() -> str:
    """
    Create a new chat using cursor-agent CLI.
    Note: This only generates an ID, doesn't create database entry.
    """
    result = subprocess.run(
        ["cursor-agent", "create-chat"],
        capture_output=True,
        text=True,
        timeout=10
    )
    
    if result.returncode == 0:
        chat_id = result.stdout.strip()
        print(f"✓ Chat ID generated: {chat_id}")
        print("⚠ Note: Database entry not created yet")
        return chat_id
    else:
        raise Exception(f"Failed to create chat: {result.stderr}")


def send_message_with_cursor_agent(chat_id: str, prompt: str) -> str:
    """
    Send a message using cursor-agent (includes chat history automatically).
    """
    result = subprocess.run(
        [
            "cursor-agent",
            "--print",
            "--force",
            "--resume", chat_id,
            prompt
        ],
        capture_output=True,
        text=True,
        timeout=60
    )
    
    if result.returncode == 0:
        response = result.stdout.strip()
        print(f"✓ Response received ({len(response)} chars)")
        return response
    else:
        raise Exception(f"cursor-agent failed: {result.stderr}")


# Complete workflow
def cursor_agent_workflow():
    """
    Complete example of cursor-agent workflow.
    
    For database handling details, see cursor-db skill EXAMPLES.mdc
    """
    # Step 1: Generate chat ID
    chat_id = create_chat_with_cursor_agent()
    
    # Step 2: Send message
    # Note: cursor-agent will create database entry automatically
    response = send_message_with_cursor_agent(
        chat_id,
        "Hello! This is a test message."
    )
    
    print(f"✓ Complete workflow succeeded")
    print(f"  Chat ID: {chat_id}")
    print(f"  Response: {response[:100]}...")
```

## See Also

- Main skill documentation: [SKILL.mdc](SKILL.mdc)
- **Database operations:** [cursor-db skill](../cursor-db/EXAMPLES.mdc)
- REST API implementation: `/Users/davell/Documents/github/blink/rest/cursor_chat_api.py`
- Cursor authentication tools: `/Users/davell/Documents/github/blink/tools/`
